package pro.belbix.tim.properties;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.google.protobuf.InvalidProtocolBufferException;
import lombok.Getter;
import lombok.Setter;
import lombok.ToString;
import org.apache.commons.codec.DecoderException;
import org.apache.commons.codec.binary.Hex;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Configuration;
import org.springframework.validation.annotation.Validated;
import pro.belbix.tim.protobuf.srsi.Srsi;

@Configuration
@Validated
@ConfigurationProperties(prefix = "tim.strategies.srsi2")
@Getter
@Setter
@ToString
@JsonIgnoreProperties(ignoreUnknown = true)
//@PropertySource(name = "srsi2", value = "classpath:srsi2.yml", factory = YamlPropertyLoaderFactory.class)
public class Srsi2Properties implements StrategyPropertiesI {
    //COMMON
    private boolean useMarketOrders = false;
    private boolean useLong = true;
    private boolean useShort = true;
    private boolean computeSrsi = true;
    private boolean printProcessing = true;

    private String nodes = "0A500800120B09000000000000144010001A0B0900000000000024401000220B09000000000000000010002A0B0900000000000059401000320B09000000000000000010003A0B09000000000000344010000A500801120B0900000000000024C010001A0B0900000000000014401000220B09000000000000000010002A0B0900000000000059401000320B09000000000000000010003A0B09000000000000344010000A500802120B0900000000000024C010001A0B0900000000000014401000220B09000000000000000010002A0B0900000000000059401000320B09000000000000000010003A0B09000000000000344010000A500800120B09000000000000144010001A0B0900000000000024401000220B09000000000000000010002A0B0900000000000059401000320B09000000000000000010003A0B09000000000000344010000A500801120B0900000000000024C010001A0B0900000000000014401000220B09000000000000000010002A0B0900000000000059401000320B09000000000000000010003A0B09000000000000344010000A500802120B0900000000000024C010001A0B0900000000000014401000220B09000000000000000010002A0B0900000000000059401000320B09000000000000000010003A0B090000000000003440100012500800120B0900000000000024C010001A0B0900000000000014C01000220B09000000000000000010002A0B0900000000000059401000320B09000000000000000010003A0B090000000000003440100012500801120B0900000000000039C010001A0B0900000000000039401000220B09000000000000000010002A0B0900000000000059401000320B09000000000000000010003A0B090000000000003440100012500802120B0900000000000049C010001A0B0900000000000049401000220B09000000000000000010002A0B0900000000000059401000320B09000000000000000010003A0B09000000000000344010001A500800120B0900000000000024C010001A0B0900000000000014C01000220B09000000000000000010002A0B0900000000000059401000320B09000000000000000010003A0B09000000000000344010001A500801120B0900000000000039C010001A0B0900000000000039401000220B09000000000000000010002A0B0900000000000059401000320B09000000000000000010003A0B09000000000000344010001A500802120B0900000000000049C010001A0B0900000000000049401000220B09000000000000000010002A0B0900000000000059401000320B09000000000000000010003A0B0900000000000034401000";

    public Srsi toSrsi() {
        try {
            return Srsi.parseFrom(Hex.decodeHex(getNodes()));
        } catch (InvalidProtocolBufferException | DecoderException e) {
            System.out.println("Error decode srsi" + e.getMessage());
            return null;
        }
    }
}
